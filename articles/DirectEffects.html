<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimating controlled direct effects • DirectEffects</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating controlled direct effects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DirectEffects</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/DirectEffects.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/did_cde.html">Difference-in-differences Designs</a></li>
    <li><a class="dropdown-item" href="../articles/sequential_g.html">Sequential g-estimation</a></li>
    <li><a class="dropdown-item" href="../articles/telescope_matching.html">Telescope matching</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mattblackwell/DirectEffects/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimating controlled direct effects</h1>
            
            <h4 data-toc-skip class="date">2025-02-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mattblackwell/DirectEffects/blob/master/vignettes/DirectEffects.Rmd" class="external-link"><code>vignettes/DirectEffects.Rmd</code></a></small>
      <div class="d-none name"><code>DirectEffects.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates how to estimate the controlled direct
effect of some treatment, net the effect of some mediator using
sequential g-estimation approach as described by <span class="citation">Acharya, Blackwell, and Sen (<a href="#ref-AchBlaSen16">2016</a>)</span>. With standard regression and
matching approaches, estimating the controlled direct effect is
difficult because it often requires adjusting for covariates that
causally affect the mediator and are causally affected by the treatment.
Including such variables in a regression model can lead to
post-treatment bias when estimating the direct effect of treatment. A
large class of models and estimation approaches have been developed to
avoid this problem, but here we focus on one called sequential
g-estimation. This approach uses a standard linear model to estimate the
effect of the mediator, and then removes that effect from effect from
the dependent variable to estimate the direct effect of treatment
without post-treatment bias.</p>
<div class="section level2">
<h2 id="quantity-of-interest">Quantity of interest<a class="anchor" aria-label="anchor" href="#quantity-of-interest"></a>
</h2>
<p>Here we briefly introduce some of the statistical theory behind
estimating direct effects. The main quantity of interest is the average
controlled direct effect or ACDE. This can be illustrated from the
following causal structure <span class="citation">(<a href="#ref-AchBlaSen16">Acharya, Blackwell, and Sen 2016, fig.
3</a>)</span>:</p>
<div class="float">
<img src="figures%2FABS_fig3.png" width="600" alt="DAG with direct effects structure"><div class="figcaption">DAG with direct effects structure</div>
</div>
<p>The average controlled direct effect defined for a given treatment
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">A_i = a</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><msup><mi>a</mi><mi>′</mi></msup></mrow><annotation encoding="application/x-tex">A_i = a^\prime</annotation></semantics></math>)
and a given value of the mediator
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">M_i = m</annotation></semantics></math>)
is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>C</mi><mi>D</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msup><mi>a</mi><mi>′</mi></msup><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>a</mi><mi>′</mi></msup><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">ACDE(a, a^\prime, m) = E[Y_i(a, m) - Y_i(a^\prime, m)]</annotation></semantics></math>
and is the total of the dashed lines in the figure above. Thus, we hold
the mediator constant when comparing the outcome under each treatment.
The ACDE is useful for discriminating between causal mechanisms, because
the average total effect of treatment,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msup><mi>a</mi><mi>′</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>≡</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>a</mi><mi>′</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\tau(a, a^\prime) \equiv E[Y_i(a) - Y_i(a^\prime)]</annotation></semantics></math>,
can be decomposed as the sum of three quantities: (1) the ACDE, (2) the
average natural indirect effect, and (3) a reference interaction that
measures of how much the direct effect of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>i</mi></msub><annotation encoding="application/x-tex">A_i</annotation></semantics></math>
depends on a particular
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">M_i = m</annotation></semantics></math>.
Thus, if the ACDE is non-zero, it is evidence that the effect of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>i</mi></msub><annotation encoding="application/x-tex">A_i</annotation></semantics></math>
is not entirely explained by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mi>i</mi></msub><annotation encoding="application/x-tex">M_i</annotation></semantics></math>.
We illustrate this with an empirical example. For more information on
this, see <span class="citation">Acharya, Blackwell, and Sen (<a href="#ref-AchBlaSen16">2016</a>)</span>.</p>
</div>
<div class="section level2">
<h2 id="implementation">Implementation<a class="anchor" aria-label="anchor" href="#implementation"></a>
</h2>
<p>This vignette introduces a new way to design, specify, and implement
various estimators for controlled direct effects using a coding style
that we refer to as the “assembly line.” Users can specify the various
components of the estimators sequentially and easily swap out
implementation details such as what exact estimators are used for the
estimation of each nuisance function or what arguments to pass to these
functions. A unified structure and output across different research
designs and estimators should make comparing estimators very easy.
Finally, this implementation is built around the idea of cross-fitting
for nuisance function estimation.</p>
<p>Let’s see how this works in practice. We first load a subset of the
<code>jobcorps</code> data from the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"jobcorps"</span><span class="op">)</span></span>
<span><span class="va">jc</span> <span class="op">&lt;-</span> <span class="va">jobcorps</span><span class="op">[</span></span>
<span>  <span class="fl">1</span><span class="op">:</span><span class="fl">200</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treat"</span>, <span class="st">"female"</span>, <span class="st">"age_cat"</span>, <span class="st">"work2year2q"</span>, <span class="st">"pemplq4"</span>, <span class="st">"emplq4"</span>, <span class="st">"exhealth30"</span><span class="op">)</span></span>
<span><span class="op">]</span></span></code></pre></div>
<p>This is the Job Corps experiment data used in <span class="citation">Huber (<a href="#ref-Hub14">2014</a>)</span> to
estimate the effect of a randomized job training program on
self-assessed health holding constant the intermediate outcome of
employment. We use a subset of the variables from their study, but the
basic variable we use here:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
is an indicator for whether participants reported “very good” health
after 2.5 years out after randomization (<code>exhealth30</code>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>i</mi></msub><annotation encoding="application/x-tex">A_i</annotation></semantics></math>
is an indicator for assignment to the job training program
(<code>treat</code>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mi>i</mi></msub><annotation encoding="application/x-tex">M_i</annotation></semantics></math>
is an indicator for employment 1 to 1.5 years after assignment
(<code>work2year2q</code>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Z_i</annotation></semantics></math>
are the post-treatment, pre-mediator intermediate confounders
(<code>emplq4</code>, <code>pemplq4</code>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>
are the pre-treatment characteristics (<code>female</code>,
<code>age_cat</code>)</li>
</ul>
<p>In context of our CDE estimators, we refer to be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>i</mi></msub><annotation encoding="application/x-tex">A_i</annotation></semantics></math>
(the treatment) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mi>i</mi></msub><annotation encoding="application/x-tex">M_i</annotation></semantics></math>
(the mediator) as <em>treatment variables</em> because we are interested
in causal effects that contrast different combinations of these two
variables.</p>
<p>The first step in our assembly line is to choose the type of CDE
estimator (or really estimation strategy) that we want to pursue. These
choices include IPW (<code><a href="../reference/cde_ipw.html">cde_ipw()</a></code>), regression imputation
(<code><a href="../reference/cde_reg_impute.html">cde_reg_impute()</a></code>), and augmented IPW
(<code><a href="../reference/cde_aipw.html">cde_aipw()</a></code>) among others. Some of these different
functions will take different arguments to specify different aspects of
the estimator. The AIPW estimator is useful to demonstrate because it
uses many of the features of the assembly line approach.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_aipw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cde_aipw.html">cde_aipw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_treatment.html">set_treatment</a></span><span class="op">(</span><span class="va">treat</span>, <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">age_cat</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/treat_model.html">treat_model</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/outreg_model.html">outreg_model</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_treatment.html">set_treatment</a></span><span class="op">(</span><span class="va">work2year2q</span>, <span class="op">~</span> <span class="va">emplq4</span> <span class="op">+</span> <span class="va">pemplq4</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/treat_model.html">treat_model</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/outreg_model.html">outreg_model</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">exhealth30</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">work2year2q</span>, data <span class="op">=</span> <span class="va">jobcorps</span><span class="op">)</span></span></code></pre></div>
<p>The call here consists of several steps connected by R’s pipe
operator. The first call <code><a href="../reference/cde_aipw.html">cde_aipw()</a></code> simply initializes the
estimator as taking the AIPW form, meaning that it will use both
propensity score models and outcome regressions to estimate the causal
effects.</p>
<p>Following this we have two blocks of 3 lines each that look similar
with a few differences. These “treatment blocks” specify the causal
variables of interest <strong>in their causal ordering</strong>. In
<code><a href="../reference/set_treatment.html">set_treatment()</a></code> we set the name of the treatment variable
and give a formula describing the pre-treatment covariates for this
treatment. This formula, unless overridden by the next two functions,
will be used in the fitting of the propensity score and outcome
regression models. <code><a href="../reference/treat_model.html">treat_model()</a></code> allows the user to specify
how to fit the propensity score model for this treatment with a choice
of engine and optional arguments to pass to each engine.
<code><a href="../reference/outreg_model.html">outreg_model()</a></code> does the same for the outcome regression. We
repeat this specification for the mediator.</p>
<p>The <code><a href="../reference/estimate.html">estimate()</a></code> function finally implements the
specifications given in the previous commands. Users use a formula to
set the outcome and which of the treatment variables we want effects for
and indicate the data frame where all of these variables can be found.
By default, the nuisance functions (the propensity score model and the
outcome regression) are fit using cross-fitting.</p>
<p>We can either use the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> or <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>
functions to get a summary of the different effects being estimated:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">my_aipw</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  aipw CDE Estimator</span></span>
<span><span class="co">## ---------------------------</span></span>
<span><span class="co">## Causal variable: treat </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Treatment model: treat ~ female + age_cat </span></span>
<span><span class="co">## Treatment engine: logit </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Outcome model: ~female + age_cat </span></span>
<span><span class="co">## Outcome engine: lm </span></span>
<span><span class="co">## ---------------------------</span></span>
<span><span class="co">## Causal variable: work2year2q </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Treatment model: work2year2q ~ emplq4 + pemplq4 + female + age_cat </span></span>
<span><span class="co">## Treatment engine: logit </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Outcome model: ~emplq4 + pemplq4 + female + age_cat </span></span>
<span><span class="co">## Outcome engine: lm </span></span>
<span><span class="co">## ---------------------------</span></span>
<span><span class="co">## Cross-fit: TRUE </span></span>
<span><span class="co">## Number of folds: 5 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated Effects:</span></span>
<span><span class="co">##                                  Estimate Std. Error t value Pr(&gt;|t|)  CI Lower</span></span>
<span><span class="co">## treat [(1, 0) vs. (0, 0)]        0.035713    0.02243  1.5923  0.11141 -0.008261</span></span>
<span><span class="co">## treat [(1, 1) vs. (0, 1)]        0.029432    0.01397  2.1068  0.03517  0.002046</span></span>
<span><span class="co">## work2year2q [(0, 1) vs. (0, 0)]  0.005647    0.02056  0.2747  0.78354 -0.034653</span></span>
<span><span class="co">## work2year2q [(1, 1) vs. (1, 0)] -0.002415    0.01661 -0.1454  0.88440 -0.034975</span></span>
<span><span class="co">##                                 CI Upper   DF</span></span>
<span><span class="co">## treat [(1, 0) vs. (0, 0)]        0.07969 3818</span></span>
<span><span class="co">## treat [(1, 1) vs. (0, 1)]        0.05682 6207</span></span>
<span><span class="co">## work2year2q [(0, 1) vs. (0, 0)]  0.04595 3991</span></span>
<span><span class="co">## work2year2q [(1, 1) vs. (1, 0)]  0.03015 6034</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">my_aipw</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                            term     estimate  std.error</span></span>
<span><span class="co">## treat_1_0             treat [(1, 0) vs. (0, 0)]  0.035713274 0.02242931</span></span>
<span><span class="co">## treat_1_1             treat [(1, 1) vs. (0, 1)]  0.029432067 0.01396992</span></span>
<span><span class="co">## work2year2q_0_1 work2year2q [(0, 1) vs. (0, 0)]  0.005647071 0.02055532</span></span>
<span><span class="co">## work2year2q_1_1 work2year2q [(1, 1) vs. (1, 0)] -0.002414928 0.01660949</span></span>
<span><span class="co">##                  statistic    p.value     conf.low  conf.high   df</span></span>
<span><span class="co">## treat_1_0        1.5922593 0.11140923 -0.008261301 0.07968785 3818</span></span>
<span><span class="co">## treat_1_1        2.1068168 0.03517349  0.002046182 0.05681795 6207</span></span>
<span><span class="co">## work2year2q_0_1  0.2747256 0.78354131 -0.034652831 0.04594697 3991</span></span>
<span><span class="co">## work2year2q_1_1 -0.1453945 0.88440430 -0.034975457 0.03014560 6034</span></span></code></pre>
<p>Because the <code><a href="../reference/estimate.html">estimate()</a></code> function included both
<code>treat</code> and <code>work2year2q</code> in the formula, the
output includes both the controlled direct effects of the treatment and
the conditional average treatment effect of the mediator. Furthermore,
by default, the output contains estimates for an effect for each
combination of other treatment variables. This can be changed by setting
the <code>eval_vals</code> argument in the relevant
<code><a href="../reference/set_treatment.html">set_treatment()</a></code> call.</p>
<p>The modular structure of the call allow users to easily swap out
parts of the models. For example, we could easily alter the above call
to use lasso versions of the regression and logit model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_aipw_lasso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cde_aipw.html">cde_aipw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_treatment.html">set_treatment</a></span><span class="op">(</span><span class="va">treat</span>, <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">age_cat</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/treat_model.html">treat_model</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"rlasso_logit"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/outreg_model.html">outreg_model</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"rlasso"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_treatment.html">set_treatment</a></span><span class="op">(</span><span class="va">work2year2q</span>, <span class="op">~</span> <span class="va">emplq4</span> <span class="op">+</span> <span class="va">pemplq4</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/treat_model.html">treat_model</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"rlasso_logit"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/outreg_model.html">outreg_model</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"rlasso"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">exhealth30</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">work2year2q</span>, data <span class="op">=</span> <span class="va">jobcorps</span><span class="op">)</span></span></code></pre></div>
<p>Here we use a “rigorous” version of the lasso from the
<code>hdm</code> package to speed up computation. There are a number of
different engines for different outcome and treatment types
including:</p>
<ul>
<li>GLMs: <code>lm</code> (OLS), <code>logit</code> (logistic
regression), <code>multinom</code> (mulitnomial logit)</li>
<li>LASSO estimators (from <code>glmnet</code>): <code>lasso</code>,
<code>lasso_logit</code>, <code>lasso_multinom</code>
</li>
<li>Rigorous LASSO estimator (from <code>hdm</code>):
<code>rlasso</code>, <code>rlasso_logit</code>
</li>
</ul>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-AchBlaSen16" class="csl-entry">
Acharya, Avidit, Matthew Blackwell, and Maya Sen. 2016.
<span>“Explaining Causal Findings Without Bias: Detecting and Assessing
Direct Effects.”</span> <em>American Political Science Review</em> 110
(3): 512–29. <a href="https://doi.org/10.1017/S0003055416000216" class="external-link">https://doi.org/10.1017/S0003055416000216</a>.
</div>
<div id="ref-Hub14" class="csl-entry">
Huber, Martin. 2014. <span>“Identifying Causal Mechanisms (Primarily)
Based on Inverse Probability Weighting.”</span> <em>Journal of Applied
Econometrics</em> 29 (6): 920–43.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Blackwell, Avidit Acharya, Maya Sen, Shiro Kuriwaki, Jacob Brown, Anton Strezhnev.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
